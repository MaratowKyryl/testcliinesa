version: 2.1

jobs:
  build:
    docker:
      - image: circleci/android:api-30 # For Android tools, use a specific image

    steps:
      # Checkout code
      - checkout

      # Install Node.js and npm dependencies
      - run:
          name: Install Node.js and NPM dependencies
          command: |
            curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.40.1/install.sh | bash
            export NVM_DIR="$HOME/.nvm"
            [ -s "$NVM_DIR/nvm.sh" ] && \. "$NVM_DIR/nvm.sh"  # This loads nvm
            [ -s "$NVM_DIR/bash_completion" ] && \. "$NVM_DIR/bash_completion"  # This loads nvm bash_completion
            nvm install node
            npm install -g npm
            npm install
      # Build the Android APK
      - run:
          name: Build Android APK
          command: |
            cd android
            ./gradlew assembleRelease

workflows:
  version: 2
  build:
    jobs:
      - build
